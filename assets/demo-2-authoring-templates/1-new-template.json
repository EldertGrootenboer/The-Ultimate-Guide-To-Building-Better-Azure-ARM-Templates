/*
What we will be doing in this template.
    1. Create ARM template
    2. Add Cosmos DB resource
    3. Parameterize template
    4. Use functions for names
    5. Add child resources
    6. Create multiple containers using copy loop
    7. Update dependsOn references
    8. Create parameter file
*/
{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "name": {
            "type": "string"
        }
    },
    "functions": [],
    "variables": {
        "uniqueName": "[concat(parameters('name'), uniqueString(resourceGroup().id))]"
    },
    "resources": [
        {
            "name": "[variables('uniqueName')]",
            "type": "Microsoft.DocumentDB/databaseAccounts",
            "apiVersion": "2019-12-12",
            "location": "[resourceGroup().location]",
            "tags": {
            },
            "kind": "GlobalDocumentDB",
            "properties": {
                "consistencyPolicy": {
                    "defaultConsistencyLevel": "Eventual",
                    "maxStalenessPrefix": 1,
                    "maxIntervalInSeconds": 5
                },
                "locations": [
                    {
                        "locationName": "location1",
                        "failoverPriority": 0
                    }
                ],
                "databaseAccountOfferType": "Standard",
                "ipRangeFilter": "ipRangeFilter",
                "enableAutomaticFailover": true,
                "capabilities": [
                    {
                        "name": "EnableTable"
                    }
                ]
            }
        }
    ],
    "outputs": {}
}